<!DOCTYPE html>
<html lang="jp">

<head>
  <mata charaset="UTF-8">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css')}}" type="text/css">
    <title>売買利益計算ツール</title>
</head>

<body>
  <div class="container">
    <h1>売買利益計算ツール</h1>

    <form method="post" class="form-box">
      <div class="field">
        <label>商品名</label>
        <input type="text" name="name" class="single">
      </div>
      <div class="field">
        <label>売値</label>
        <input type="text" name="price" class="single">
      </div>
      <div class="field">
        <label>原価</label>
        <input type="text" name="cost_price" class="single">
      </div>
      <div class="field">
        <label>送料</label>
        <input type="text" name="shipping" class="single">
      </div>
      <button type="submit">計算する</button>
    </form>
    <form action="/import" method="post" enctype="multipart/form-data" class="import-form">
      <div>
        <input type="file" name="file" accept=".csv">
        <button type="submit">CSVインポート</button>
      </div>
    </form>
    <p>
      <a href="/history" class="btn-history">履歴一覧を表示</a>
    </p>

    {% if error %}
    <p class="error_message">{{ error }}</p>
    {% endif %}
    {% if result %}
    <div class="result-box">
      <h2>計算結果</h2>
      <p>商品名:{{ result.商品名 }}</p>
      <p>価格:{{ result.価格 }} 円</p>
      <p>原価:{{ result.原価 }} 円</p>
      <p>送料:{{ result.送料 }} 円</p>
      <p>利益:{{ result.利益 }} 円</p>
      <p>利益率:{{ result.利益率 }} %</p>
      <p class="judge {{ result.判定カラー }}">
        {{ result.判定 }}
      </p>
    </div>
    {% endif %}
    {% if import_success %}
    <p class="success">CSVインポートに成功しました。</p>
    <div class="result-box">
      <h2>計算結果
        <table border="1">
          <tr>
            <th>商品名</th>
            <th>利益</th>
            <th>利益率</th>
            <th>判定</th>
          </tr>
          {% for r in import_records %}
          <tr>
            <td>{{ r["商品名"] }}</td>
            <td>{{ r["利益"] }}</td>
            <td>{{ r["利益率"] }}%</td>
            <td class="judge {{ r.判定カラー }}">{{ r["判定"] }}</td>
          </tr>
          {% endfor %}
        </table>
    </div>
    {% endif %}
  </div>
</body>

</html>